<link
  rel="stylesheet"
  href="{{ 'screenlux.css' | asset_url }}&v={{ 'now' | date: '%N' }}"
  media="print"
  onload="this.media='all'"
>
<noscript>{{ 'screenlux.css' | asset_url | stylesheet_tag }}</noscript>
{% render 'screenlux-data' %}

<script src="{{ 'screenlux-engine.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'media-gallery.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'details-accordion.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'hybrid-quantity-selector.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-configurator.js' | asset_url }}&v={{ 'now' | date: '%N' }}" defer="defer"></script>

<div class="page-width screenlux-product-container">
  <!-- Left Column: Sticky Media Gallery -->
  <div class="sticky-media-col product__media-wrapper screenlux-gallery">
    {% render 'product-media-gallery', product: product %}
  </div>

  <!-- Right Column: Configurator Form -->
  <div class="product__info-wrapper">
    <h1>{{ product.title }}</h1>
    <div class="product__description">
      <details-accordion class="accordion">
        <details>
          <summary>Read more</summary>
          <div class="accordion__content">
            {{ product.description }}
          </div>
        </details>
      </details-accordion>
    </div>

    <!-- The Custom Application Root -->
    <script>
      console.log('Screenlux Data Loaded:', window.ScreenluxData);
      if (!window.ScreenluxData) console.error('ScreenluxData is missing!');
      if (window.ScreenluxData && window.ScreenluxData.screens.length === 0)
        console.warn('ScreenluxData.screens is empty! Check collection "main-product".');
    </script>
    <product-configurator>
      <div
        id="loading-fallback"
        style="padding: 20px; text-align: center; border: 1px dashed #ccc; background: #fafafa;"
      >
        <h3>Configuration Loading...</h3>
        <p>If this does not disappear, no products were found in the "main-product" collection.</p>
        <p><small>(Check Console for details)</small></p>
      </div>
      <!--
        The content here is rendered by JS.
        We pass the cart-add-url for the engine to use.
      -->
      <input type="hidden" name="cart-add-url" value="{{ routes.cart_add_url }}">
    </product-configurator>
  </div>
</div>

{% schema %}
{
  "name": "Product Configurator",
  "tag": "section",
  "class": "section",
  "settings": []
}
{% endschema %}
