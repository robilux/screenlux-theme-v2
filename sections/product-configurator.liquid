<link
  rel="stylesheet"
  href="{{ 'screenlux.css' | asset_url }}&v={{ 'now' | date: '%N' }}"
  media="print"
  onload="this.media='all'"
>
<link rel="stylesheet" href="{{ 'component-slider.css' | asset_url }}" media="print" onload="this.media='all'">
<noscript>{{ 'screenlux.css' | asset_url | stylesheet_tag }}</noscript>
{% render 'screenlux-data' %}

<script src="{{ 'global.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'screenlux-engine.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'media-gallery.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-description.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'hybrid-quantity-selector.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-configurator-v2.js' | asset_url }}&v=DesignV2_{{ 'now' | date: '%N' }}" defer="defer"></script>

<div class="page-width screenlux-product-container">
  <!-- Left Column: Sticky Media Gallery -->
  <div class="sticky-media-col product__media-wrapper screenlux-gallery">
    {% render 'product-media-gallery', product: product %}
  </div>

  <!-- Right Column: Configurator Form -->
  <div class="product__info-wrapper">
    <div class="product-title-section">
      <h1 class="product-title">{{ product.title }}</h1>
      <div class="developed-badge">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M8 5V8L10 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Developed in Germany</span>
      </div>
    </div>

    <product-description class="product__description">
      <div class="description-content">
        {{ product.description }}
      </div>
      <button type="button" class="description-toggle-btn">Read more</button>
    </product-description>

    <!-- The Custom Application Root -->
    <script>
      console.log('Screenlux Data Loaded:', window.ScreenluxData);
      if (!window.ScreenluxData) console.error('ScreenluxData is missing!');
      if (window.ScreenluxData && window.ScreenluxData.screens.length === 0)
        console.warn('ScreenluxData.screens is empty! Check collection "main-product".');
    </script>
    <product-configurator>
      <div
        id="loading-fallback"
        style="padding: 20px; text-align: center; border: 1px dashed #ccc; background: #fafafa;"
      >
        <h3>Configuration Loading...</h3>
        <p>If this does not disappear, no products were found in the "main-product" collection.</p>
        <p><small>(Check Console for details)</small></p>
      </div>
      <!--
        The content here is rendered by JS.
        We pass the cart-add-url for the engine to use.
      -->
      <input type="hidden" name="cart-add-url" value="{{ routes.cart_add_url }}">
    </product-configurator>
  </div>
</div>

{% schema %}
{
  "name": "Product Configurator",
  "tag": "section",
  "class": "section",
  "settings": []
}
{% endschema %}
